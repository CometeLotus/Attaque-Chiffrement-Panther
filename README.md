# Panther Cipher Implementation and Attacks

## Overview
This project involves the implementation of the **Panther** authenticated encryption scheme, a lightweight cipher designed for both confidentiality and authentication. The project also includes attacks that break the cipher, inspired by research conducted by **Christina Boura**, **Rachelle Heim Boissier**, and **Yann Rotella**.

Panther was originally introduced at the Indocrypt 2021 conference and is based on a sponge function that uses four Non-linear Feedback Shift Registers (NFSRs). The attacks implemented in this project demonstrate how Panther can be fully broken using a known plaintext/ciphertext pair with minimal computational resources.

## Structure

- **Panther Encryption**: Implementation of Panther cipher using Python.
- **Panther Attacks**: Two attacks implemented in Python:
  - Known plaintext/ciphertext attack.
  - Ciphertext-only attack to retrieve part of the plaintext.

## Key Concepts

### Panther Cipher
Panther is an authenticated encryption scheme that uses a sponge function with the following key components:
1. **State**: The internal state of the cipher is 328 bits, divided into two parts:
   - **Rate (r)**: 64 bits.
   - **Capacity (c)**: 264 bits.
2. **NFSR**: The state is updated using four NFSRs, iterated multiple times during different phases of encryption.

### Sponge Function
A sponge function takes an input of arbitrary length and returns an output of any desired length. It operates in two phases:
- **Absorption**: Input data is XORed with the internal state and processed in blocks.
- **Squeezing**: The output is generated by extracting blocks from the internal state.

### Authenticated Encryption
Panther provides both encryption and authentication by generating a ciphertext and an authentication tag based on the key, plaintext, and associated data. Upon decryption, the tag is verified to ensure integrity.

## Attacks on Panther
### Known Plaintext/Ciphertext Attack
This attack recovers the secret key using a single known plaintext/ciphertext pair by exploiting weaknesses in the limited number of iterations during the absorption phase. The attack works by reversing the state transitions and retrieving the key.

### Ciphertext-only Attack
This attack recovers part of the plaintext using only the ciphertext. By manipulating the state transitions and applying the cipher in reverse, we retrieve the plaintext of later blocks.

## Requirements
- **Python 3.6+**
- **Libraries**: No additional libraries are required; all functions are built-in.

## How to Run

To run the project:
1. Clone or download the project files to your local machine.
2. Open a terminal and navigate to the project directory.
3. Run the following command:
    ```bash
    python Panther.py
    ```
4. The program will output test results in the terminal, showing the encryption, decryption, and attack results.

**Note: The same key, IV, and plaintext are used for every run by default. For variability, you can modify the code to use random generators for these values.**

## Acknowledgements
This project is based on research by **Christina Boura**, **Rachelle Heim Boissier**, and **Yann Rotella**. We thank them for their work and for providing the resources that made this project possible.

For further information, see their research paper: [Breaking Panther](https://eprint.iacr.org/2022/111.pdf).

## References
- Bhargavi, K. V. L., Srinivasan, C., & Lakshmy, K. V. "Panther: A Sponge Based Lightweight Authenticated Encryption Scheme," Indocrypt, 2021.
- Boura, C., Heim Boissier, R., & Rotella, Y. "Breaking Panther," Universit√© Paris-Saclay, UVSQ, CNRS, 2022. [Breaking Panther](https://eprint.iacr.org/2022/111.pdf)
- [Wikipedia - Sponge Functions](https://en.wikipedia.org/wiki/Sponge_function)
